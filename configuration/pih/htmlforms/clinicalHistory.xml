<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http//license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->



<htmlform formName="Historia clinica"
          formUuid="02af1035-41d6-478e-9501-1ca6d38a4d03"
          formEncounterType="0d16a7c9-07fb-43f6-8984-dd7787f26a5a"
          formVersion="1.0">

    <style type="text/css">

        .field-error {
            color: #ffc0b5;
            font-size: 1.1em;
            display: block;
        }

        .two-columns {
            display: table;
            height: 100%;
            width: 100%;
        }

        .two-columns > div {
            display: table-cell;
            width: 50%;
        }

        .three-columns {
            display: table;
            height: 100%;
            width: 100%;
        }

        .three-columns > div {
            display: table-cell;
            width: 33%;
        }

        .four-columns {
            display: table;
            height: 100%;
            width: 100%;
        }

        .four-columns > div {
            display: table-cell;
            width: 20%;
        }

        .centered-header{
            text-align: center;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .margin-bottom{
            margin-bottom: 45px;
        }

        form fieldset {
            min-width: 90%;
            display: block;
            border: 1px solid rgba(52, 58, 64, 0.5);
        }

        div.inline-radio > * {
            display: inline;
            float: none !important;
            min-width: initial;
        }

        .light-font {
            font-family: "OpenSansLight",sans-serif;
        }

        .section-container input[type="checkbox"] {
            margin: 0px 5px; /*changed values to vertical, horizontal*/
            top:5px; /*added to offset the checkbox position to line up*/
        }

        .section-container label { /*new definition to override labels inside section-containers*/
            margin: 0px;
        }

       .section {
         width: 95%;
         margin-bottom: 30px;
        }

        legend {
          width: auto;
          font-size: 16px;
        }

        textarea {
            width: 95%;
        }

        /* Grey out disabled checkboxes */
        input[type=checkbox][disabled] {
            filter: invert(15%);
        }

        #diagnosis-lookup {
            display: inline-block;
            width: 50%;
            vertical-align: top;
        }

        #encounter-diagnoses-target {
            display: inline-block;
            width: 40%;
            vertical-align: top;
        }

        .hidden {
            display:none;
        }

    </style>

  

    <div class="print-form-datestamps" style="display:none">
        <p><uimessage code="created_on"/>:
            <lookup complexExpression="$form.dateCreated"/>
        </p>
        <p><uimessage code="last_updated_on"/>:
            <lookup complexExpression="$form.dateChanged"/>
        </p>
        <p><uimessage code="printed_on"/>:
            <lookup complexExpression="$formGeneratedDatetime"/>
        </p>
    </div>

    <div class="hidden" id="encounter-details">
        <encounterDate default="now"/>
        <encounterProviderAndRole default="currentUser" 
                                  encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05"
                                  required="true"/>

    </div>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title">
        <div>
            <label>
                <uimessage code="pihcore.locationRequired"/>
            </label>
            <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
        </div>
    </section>

    <ifMode mode="VIEW" include="false">
        <h1>Antecedentes</h1>
    </ifMode>       

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Hereditarios">

        <ifMode mode="VIEW" include="false" >
                <script type="text/javascript">
                    jq(function () {
                        setupRespiratoryRisk('<lookup expression="fn.latestObs('PIH:12586').valueNumeric"/>',
                                             '<lookup expression="fn.latestObs('PIH:12998').valueNumeric"/>'
                        );
                    });
                </script>
        </ifMode> 

        <p class="font-size-16 centered-header">Diagnósticos de antecedentes familiares:</p>
        <div class="four-columns margin-bottom">
             <familyHistoryRelativeCheckboxes concept="CIEL:121375" label="Asma" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>
             <familyHistoryRelativeCheckboxes concept="CIEL:119481" label="Diabetes" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>
             <familyHistoryRelativeCheckboxes concept="CIEL:155" label="Epilepsia" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>
             <familyHistoryRelativeCheckboxes concept="CIEL:139071" label="Enfermedad del corazón" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>
        </div>

        

        <div class="four-columns margin-bottom">    
             <familyHistoryRelativeCheckboxes concept="CIEL:117399" label="Hipertesion, HTA" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>
             <familyHistoryRelativeCheckboxes concept="CIEL:112141" label="Tuberculosis" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>
             <familyHistoryRelativeCheckboxes concept="CIEL:116031" label="Cancer" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER" specify="true"/>
             <familyHistoryRelativeCheckboxes concept="PIH:7416" label="Otro" specify="true" relatives="PIH:FATHER,PIH:MOTHER,PIH:OTHER"/>    
        </div>
    
    </section>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Personales no patológicos">
 
        <p class="font-size-16 centered-header">Transfuciones:</p>

        <div class="three-columns margin-bottom">
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:13748').valueNumeric"/>
                <obs id="ldl" 
                     conceptId="PIH:13748" 
                     showUnits="false"
                     labelText="Número de transfuciones"
                     class="font-size-16"/>
            </div>
            <div>
                <lookup class="hidden" expression="fn.latestObs('CIEL:163268').valueDate"/>
                <obs conceptId="CIEL:163268" 
                     allowFutureDates="false"
                     labelText="Fecha de última tranfución:"
                     class="font-size-16"/>
            </div>
            <div>
                <obs conceptId="PIH:7864"
                     labelText="Tipo de tranfución:"
                     class="font-size-16"/>
            </div>
        </div>

        <p class="font-size-16 centered-header">Cirugías:</p>

        <div class="three-columns margin-bottom">
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:13768').valueNumeric"/>
                <obs id="ldl" 
                     conceptId="PIH:13768" 
                     showUnits="false"
                     labelText="Número de cirugías"
                     class="font-size-16"/>
            </div>
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:13769').valueDate"/>
                <obs conceptId="PIH:13769" 
                     allowFutureDates="false"
                     labelText="Fecha de última cirugía:"
                     class="font-size-16"/>
            </div>
            <div>
                <obs conceptId="PIH:13770"
                     labelText="Tipo de cirugía:"
                     class="font-size-16"/>
            </div>
        </div>
        
        <div class="margin-bottom">
        <obs conceptId="PIH:13749" 
             style="textarea"
             labelText="Motivo de cirugía"
             rows="3"/>
        </div>

        <p class="font-size-16 centered-header">Hospitalizaciones:</p>

        <div class="two-columns margin-bottom">
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:12594').valueNumeric"/>
                <obs id="ldl" 
                     conceptId="PIH:12594" 
                     showUnits="false"
                     labelText="Número de hospitalizaciones"
                     class="font-size-16"/>
            </div>
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:12602').valueDate"/>
                <obs conceptId="PIH:12602" 
                     allowFutureDates="false"
                     labelText="Fecha de última hospitalización:"
                     class="font-size-16"/>
            </div>

        </div>

        <div class="margin-bottom">
            <obs conceptId="PIH:13770"
                 labelText="Motivo de hospitalización:"
                 style="textarea"
                 rows="3"/>
        </div>

        <div class="margin-bottom">
            <p class="font-size-16 centered-header">Otros antecedentes no patológicos:</p>
            <obs conceptId="PIH:13749"
                 style="textarea" 
                 rows="3"/>
        </div>

    </section>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Personales patológicos">
  
        <p class="font-size-16 centered-header">Tabaco y alcohol:</p>

        <div class="three-columns margin-bottom">
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:12586').valueNumeric"/>
                <obs id="NumeroCigarros"
                     conceptId="PIH:12586" 
                     showUnits="false"
                     labelText="Número de cigarros por día"
                     class="font-size-16"/>
            </div>
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:12998').valueNumeric"/>
                <obs id="AnosFumando"
                     conceptId="PIH:12998" 
                     allowFutureDates="false"
                     labelText="Tiempo fumando en años:"
                     class="font-size-16"/>
            </div>
            <div>
                <span id='calc-riesgo-tabaquico' class="value"></span>
            </div>

        </div>

        <div class="two-columns margin-bottom">
            <div>
                <p class="font-size-16">Ingiere bebidas alcoholicas:</p>
                <obs
                     conceptId="CIEL: 159449"
                     answerConceptIds="CIEL:1065, CIEL:1066"
                     style="radio"
                     answerSeparator="">
                </obs>
            </div>
            <div>
                <lookup class="hidden" expression="fn.latestObs('PIH:2241').valueNumeric"/>
                <obs conceptId="PIH:2241" 
                     allowFutureDates="false"
                     labelText="Tiempo tomando bebidas alcoholicas en años:"
                     class="font-size-16"/>
            </div>

        </div>

        <p class="font-size-16 centered-header">Otros antecedentes patológicos:</p>
        <obs conceptId="PIH:Other pathological history comment" 
             style="textarea"
             rows="3"/>
    
    </section>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Ginecoobstetricos">

        <ifMode mode="VIEW" include="false" >
            <script type="text/javascript">
                jq(function () {
                    setUpMaternalSection(
                        '<lookup expression="encounter.getEncounterDatetime().getTime()"/>',
                        '<uimessage code="pihcore.weeks"/>'
                    );
                });
            </script>
        </ifMode>

        <div class="two-columns margin-bottom">
                
            <div>
                <label>
                    <uimessage code="pihcore.pregnancy.lastPeriod"/>
                </label>
                <obs id="lastPeriodDate" conceptId="CIEL:1427" allowFutureDates="false"/>
            </div>

            <div id="calculated-edd-and-gestational" class="hidden">
                <div id="calculated-gestational-age-wrapper">
                    <span id="calculated-gestational-age-label">
                        <uimessage code="pihcore.calculatedGestationalAge"/>:&#160;
                    </span>
                    <span id='calculated-gestational-age-value' class="value"></span>
                </div>
                <div id="calculated-edd-wrapper">
                    <span id="calculated-edd-label">
                        <uimessage code="pihcore.calculatedEstimatedDeliveryDate"/>:&#160;
                    </span>
                    <span id='calculated-edd' class="value"></span>
                </div>
            </div>

        </div>                   
            
        <div class="three-columns margin-bottom">
                
            <div>
                <label class="font-size-16">
                    <uimessage code="pihcore.mch.grava"/>
                </label>
                <obs conceptId="CIEL:5624" id="gravidaInput"/>
            </div>

            <div>
                <label class="font-size-16">
                    <uimessage code="pihcore.mch.para"/>
                </label>
                <obs conceptId="CIEL:1053" />
            </div>

            <div>
                <label class="font-size-16">
                    <uimessage code="pihcore.mch.cesarian"/>
                </label>
                <obs conceptId="CIEL:160081" />
            </div>

        </div>

        <div class="two-columns"> 

            <div>

                <p class="font-size-16">Perdidas menores de 20 SDG: </p>        
                <obs conceptId="PIH:13733" 
                     showUnits="false"/>

            </div>

            <div>

                <p class="font-size-16">Perdidas mayores de 20 SDG: </p>                   
                <obs conceptId="PIH:13734" 
                     showUnits="false"/>

            </div>
                   
        </div>
    
    </section>

    <ifMode mode="VIEW" include="false">
        <h1>Padecimientos actuales</h1>
    </ifMode>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Padecimientos">
        <div class="two-colums margin-bottom">

            <div class="margin-bottom">

                <p class="font-size-16">Síntoma principal:</p>
                <obs conceptId="CIEL:160531"/>

            </div>

            <div>
                <obs conceptId="PIH:6760" 
                     labelText="Síntomas adicionales"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>         
            </div>   
        </div>

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="CIEL:162676" 
                     labelText="Evolución de los síntomas"
                     class="font-size-16"/>
            </div>

            <div>
                <obs conceptId="PIH:13751" 
                     labelText="Especificación de evolución de los síntomas"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>         
            </div>    
        </div>

        <p class="font-size-16">Tratamiento usado anteriormente:</p>
        <obs conceptId="PIH:Previous treatment with other medications, non-coded" 
             style="textarea" 
             rows="3"/>

    </section>

    <ifMode mode="VIEW" include="false">
        <h1>Exploración física</h1>
    </ifMode>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Signos vitales">

        <div class="margin-bottom">
            <table>
                <thead>
                    <tr>
                        <td style="font-weight:bold">
                            Tipo de signo vital
                        </td>
                        <td style="font-weight:bold">
                            <uimessage code="zl.date"/>
                        </td>
                        <td style="font-weight:bold">
                            Resultado
                        </td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <uimessage code="mirebalais.vitals.bloodPressure.title" />
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:SYSTOLIC BLOOD PRESSURE').obsDatetime"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:SYSTOLIC BLOOD PRESSURE').valueNumeric.intValue()"/>
                            <lookup complexExpression="#if($fn.latestObs('PIH:SYSTOLIC BLOOD PRESSURE')) / #end" />
                            <lookup expression="fn.latestObs('PIH:DIASTOLIC BLOOD PRESSURE').valueNumeric.intValue()"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <uimessage code="mirebalais.vitals.o2sat.title"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:BLOOD OXYGEN SATURATION').obsDatetime"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:BLOOD OXYGEN SATURATION').valueNumeric.intValue()"/>
                            <span class="light-font">
                                <lookup complexExpression="#if($fn.latestObs('PIH:BLOOD OXYGEN SATURATION')) % #end" />
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <uimessage code="pihcore.lab.glucose"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:SERUM GLUCOSE').obsDatetime"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:SERUM GLUCOSE').valueNumeric.intValue()"/>
                            <span class="light-font">
                                <lookup complexExpression="#if($fn.latestObs('PIH:Fasting for blood glucose test')) #if($fn.latestObs('PIH:Fasting for blood glucose test').valueCoded.name != 'No') (en ayuno) #else (sin ayuno) #end #end" />
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <uimessage code="mirebalais.vitals.temperature.title"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:TEMPERATURE (C)').obsDatetime"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:TEMPERATURE (C)').valueNumeric"/>
                            <span class="light-font">
                                <lookup complexExpression="#if($fn.latestObs('PIH:TEMPERATURE (C)')) °C #end" />
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <uimessage code="mirebalais.vitals.heartRate.title"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:PULSE').obsDatetime"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('CIEL:5624').valueNumeric.intValue()"/>
                            <span class="light-font">
                                <lookup complexExpression="#if($fn.latestObs('CIEL:5624')) ppm #end" />
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <uimessage code="mirebalais.vitals.respiratoryRate.title"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('PIH:RESPIRATORY RATE').obsDatetime"/>
                        </td>
                        <td>
                            <lookup expression="fn.latestObs('CIEL:5624').valueNumeric.intValue()"/>
                            <span class="light-font">
                                <lookup complexExpression="#if($fn.latestObs('CIEL:5624')) rpm #end" />
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="CIEL:165983" 
                     labelText="Exploración del cuello"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
            </div>

            <div>
                <obs conceptId="CIEL:163045" 
                     labelText="Exploración de cabeza"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
               
            </div>    
        </div>

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="CIEL:160689" 
                     labelText="Exploración de torax"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
            </div>

            <div>
                <obs conceptId="CIEL:160947" 
                     labelText="Exploración de abdomen"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
               
            </div>  
        </div>

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="PIH:13754" 
                     labelText="Exploración de extremidades"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
                
            </div>  

            <div>
                <obs conceptId="CIEL:163042" 
                     labelText="Otros comentarios de exploración física:"
                     style="textarea" 
                     rows="3"/>
            </div> 
        </div> 

    </section>

    <ifMode mode="VIEW" include="false">
        <h1>Interrogatorio por aparatos</h1>
    </ifMode>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="">

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="PIH:ROS GI COMMENT" 
                     labelText="Aparato digestivo"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
            </div>

            <div>
                <obs conceptId="PIH:ROS Resp comment " 
                     labelText="Aparato respiratorio"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
               
            </div>    
        </div>

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="PIH:ROS Urinary comment" 
                     labelText="Aparato urinario"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
            </div>

            <div>
                <obs conceptId="PIH:ROS Reproductive comment" 
                     labelText="Aparato genital"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
               
            </div>  
        </div>

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="PIH:ROS CV comment" 
                     labelText="Sistema cardiovascular"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
                
            </div>  

            <div>
                <obs conceptId="PIH:ROS Nervous comment" 
                     labelText="Sistema nervioso"
                     style="textarea" 
                     rows="3"/>
            </div> 
        </div> 

        <div class="two-columns margin-bottom">
            <div>
                <obs conceptId="PIH:ROS Endocrine comment" 
                     labelText="Sistema endocrino"
                     class="font-size-16"
                     style="textarea" 
                     rows="3"/>
                
            </div>  

            <div>
                <obs conceptId="PIH:ROS MS COMMENT" 
                     labelText="Sistema locomotor"
                     style="textarea" 
                     rows="3"/>
            </div> 
        </div> 

    </section>

    <ifMode mode="VIEW" include="false">
        <h1>Diagnósticos</h1>
    </ifMode>

    <section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="">

        <div class="two-columns">
                <div id="diagnosis-lookup">
                    <encounterDiagnosesByObs selectedDiagnosesTarget="#encounter-diagnoses-target"/>
                </div>
                <div id="encounter-diagnoses-target">
                </div>
        </div>

    </section>

    <ifMode mode="VIEW" include="false">
        <div id="buttons">
            <submit submitClass="confirm right" submitCode="mirebalais.save"/>
            <button type="button" class="cancel">
                <uimessage code="emr.cancel"/>
            </button>
        </div>
    </ifMode>

</htmlform>
